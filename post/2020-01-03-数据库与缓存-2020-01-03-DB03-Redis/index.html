<!-- build time:Mon May 10 2021 22:39:48 GMT+0000 (Coordinated Universal Time) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/sr/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/sr/images/yelp32.png"><link rel="icon" type="image/png" sizes="16x16" href="/sr/images/yelp16.png"><link rel="mask-icon" href="/sr/images/logo.svg" color="#222"><link rel="stylesheet" href="/sr/css/main.css"><link rel="stylesheet" href="/sr/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-minimal.min.css"><script src="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:new URL("https://xming1001.github.io/sr").hostname,root:"/sr/",scheme:"Pisces",version:"7.6.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!0,mediumzoom:!1,lazyload:!0,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{appID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!0,preload:!0},path:"search.xml",motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="RedisRedis 简介Redis 是一个使用 C 语言编写 、 遵守 BSD 协议、支持网络、可基于内存亦可持久化的日志型、Key-Value 非关系型数据库什么是 BSD 协议?BSD 开源协议是一个给于使用者很大自由的协议。可以自由的使用，修改源代码，也可以将修改后的代码作为开源或者专有软件再发布NoSQL在 web2.0 大环境下，为了避免对关系型数据库大量 IO 操作，引入 NoSQL"><meta property="og:type" content="article"><meta property="og:title" content="DB03-Redis"><meta property="og:url" content="https://xming1001.github.io/sr/post/2020-01-03-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98-2020-01-03-DB03-Redis/index.html"><meta property="og:site_name" content="Xm"><meta property="og:description" content="RedisRedis 简介Redis 是一个使用 C 语言编写 、 遵守 BSD 协议、支持网络、可基于内存亦可持久化的日志型、Key-Value 非关系型数据库什么是 BSD 协议?BSD 开源协议是一个给于使用者很大自由的协议。可以自由的使用，修改源代码，也可以将修改后的代码作为开源或者专有软件再发布NoSQL在 web2.0 大环境下，为了避免对关系型数据库大量 IO 操作，引入 NoSQL"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2020-01-03T20:28:54.000Z"><meta property="article:modified_time" content="2021-05-10T22:39:23.776Z"><meta property="article:author" content="min"><meta property="article:tag" content="note"><meta property="article:tag" content="NoSQL"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://xming1001.github.io/sr/post/2020-01-03-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98-2020-01-03-DB03-Redis/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0}</script><title>DB03-Redis | Xm</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><a href="https://github.com/xming1001" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="60" height="60" viewBox="0 0 250 250" style="fill:#70B7FD;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-meta"><div><a href="/sr/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Xm</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">沉醉负白首，舒怀成大观<br>醒，亦在人间；梦，亦在人间~</p></div><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-去首页"><a href="/sr/" rel="section"><i class="fa fa-fw fa-home"></i>去首页</a></li><li class="menu-item menu-item-分类树"><a href="/sr/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类树</a></li><li class="menu-item menu-item-关于我"><a href="/sr/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于我</a></li><li class="menu-item menu-item-时间轴"><a href="/sr/archives/" rel="section"><i class="fa fa-fw fa-heartbeat"></i>时间轴</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜本站</a></li></ul></nav><div class="site-search"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="搜索..." spellcheck="false" type="text" id="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"></div></div><div class="search-pop-overlay"></div></div></div></header><div class="reading-progress-bar"></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content"><div class="posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://xming1001.github.io/sr/post/2020-01-03-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98-2020-01-03-DB03-Redis/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="https://s2.ax1x.com/2019/12/30/lla7HU.gif"><meta itemprop="name" content="min"><meta itemprop="description" content="欢迎瓜友~"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Xm"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">DB03-Redis</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-01-03 20:28:54" itemprop="dateCreated datePublished" datetime="2020-01-03T20:28:54+00:00">2020-01-03</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2021-05-10 22:39:23" itemprop="dateModified" datetime="2021-05-10T22:39:23+00:00">2021-05-10</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/sr/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98/" itemprop="url" rel="index"><span itemprop="name">数据库与缓存</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h2><h3 id="Redis-简介"><a href="#Redis-简介" class="headerlink" title="Redis 简介"></a>Redis 简介</h3><p>Redis 是一个使用 C 语言编写 、 遵守 BSD 协议、支持网络、可基于内存亦可持久化的日志型、Key-Value 非关系型数据库</p><div class="note info"><p>什么是 BSD 协议?<br>BSD 开源协议是一个给于使用者很大自由的协议。可以自由的使用，修改源代码，也可以将修改后的代码作为开源或者专有软件再发布</p></div><h3 id="NoSQL"><a href="#NoSQL" class="headerlink" title="NoSQL"></a>NoSQL</h3><p>在 web2.0 大环境下，为了避免对关系型数据库大量 IO 操作，引入 NoSQL 可以更好的应对高并发读写和海量数据缓存。<br>NoSQL = Not Only SQL（非关系型数据库），去除了关系数据库的关系型特性的数据库，NoSQL 不保证关系数据的 ACID 特性，大部分不提供事务的管理，与关系型数据库形成互补关系，通常 NoSQL 数据库都具有以下几点特征：<strong>易扩展、大数据量，高性能、数据模型灵活、高可用</strong></p><table><thead><tr><th>NoSQL 分类</th><th>K/V存储数据库</th><th>列存储数据库</th><th>文档型数据库</th><th>图形(Graph)数据库</th></tr></thead><tbody><tr><td><strong>典型产品</strong></td><td><strong>Redis</strong></td><td>HBase</td><td>MongoDb</td><td>Neo4J</td></tr><tr><td><strong>应用场景</strong></td><td>内容缓存，日志系统</td><td>分布式文件系统</td><td>Web应用</td><td>社交网络</td></tr></tbody></table><h3 id="Redis-较其他-K-V-数据库的优势"><a href="#Redis-较其他-K-V-数据库的优势" class="headerlink" title="Redis 较其他 K/V 数据库的优势"></a>Redis 较其他 K/V 数据库的优势</h3><p>Redis 有着更为复杂的数据结构并且提供对他们的原子性操作<br>Redis 的数据类型都是基于基本数据结构的同时对程序员透明，无需进行额外的抽象<br>Redis 运行在内存中还可以持久化到磁盘</p><h3 id="Redis-初使用"><a href="#Redis-初使用" class="headerlink" title="Redis 初使用"></a>Redis 初使用</h3><h4 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h4><ol><li>官网 <a href="https://redis.io" target="_blank" rel="noopener">https://redis.io</a> 或者中文网 <a href="http://www.redis.net.cn/" target="_blank" rel="noopener">http://www.redis.net.cn/</a></li><li>下载之后解压，在解压目录找到 <code>redis-server.exe</code> 这是 Redis 的服务器端，双击运行可以看到 Redis 的命令行界面，上面有进程 ID 和端口号，不要关闭此窗口</li><li>找到 <code>redis-cli.exe</code> 这是 Redis 的客户端，双击即可看到已连接到 Redis 服务器的端口 127.0.0.1:6379&gt;，说明已成功安装 Redis</li></ol><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><p>Windows 下的 Redis 配置文件：<code>redis.windows.conf</code></p><h3 id="Redis-数据的形式"><a href="#Redis-数据的形式" class="headerlink" title="Redis 数据的形式"></a>Redis 数据的形式</h3><p>Redis 存储的是 key+value 格式的数据，其中 key 固定为字符串 ，value 则有 5 种数据类型</p><h4 id="value-的数据类型"><a href="#value-的数据类型" class="headerlink" title="value 的数据类型"></a>value 的数据类型</h4><p><strong>字符串： string</strong>（二进制安全）<br>二进制安全的意思是 Redis 的 string 可以包含任何数据，比如 jpg 图片或者序列化的对象，string 类型是 Redis 最基本的数据类型， 最大能存储 512MB</p><p><strong>哈希： hash</strong>（类似<code>map</code>类型） 场景：查、增、改用户的属性</p><p><strong>有序列表： list</strong>（类似<code>LinkedList</code>格式，双向链表，元素可重复）场景：消息队列</p><p><strong>无序集合： set</strong>(类似<code>HashSet</code>格式，哈希表实现，元素不允许重复，无序) 场景：两个用户之间的共同好友数</p><p><strong>有序集合： zset(sorted set)</strong>(不允许重复，通过增加权重 score， 使存储元素从小到大排序) 场景：排行榜</p><h3 id="Redis-常见命令操作"><a href="#Redis-常见命令操作" class="headerlink" title="Redis 常见命令操作"></a>Redis 常见命令操作</h3><h4 id="通用命令"><a href="#通用命令" class="headerlink" title="通用命令"></a>通用命令</h4><p><code>keys *</code> : 查询所有键<br><code>type key</code> ： 获取键对应值的数据类型<br><code>del key</code>：删除指定键</p><h4 id="操作字符串类型数据"><a href="#操作字符串类型数据" class="headerlink" title="操作字符串类型数据"></a>操作字符串类型数据</h4><p><strong>存储</strong>：<code>set key value</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; set username zhangsan</span><br><span class="line">OK</span><br></pre></td></tr></table></figure><p><strong>获取</strong>：<code>get key</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; get username</span><br><span class="line">"zhangsan"</span><br></pre></td></tr></table></figure><p><strong>删除</strong>：<code>del key</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; del username</span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure><h4 id="操作哈希类型数据"><a href="#操作哈希类型数据" class="headerlink" title="操作哈希类型数据"></a>操作哈希类型数据</h4><p><strong>存储</strong>：<br><code>hset key field value</code> 存储一个 field 和 value 到指定 key<br><code>hmset key field1 value1 field2 value2 ... field(n) value(n)</code> 存储多个 field 和 value 到指定 key</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hset myhash username lisi</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hset myhash password 1234</span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure><p><strong>获取</strong>：<br><code>hget key field</code> 获取指定的field对应的值<br><code>hmget key field</code> 获取指定的 field 多个对应的值</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hget myhash username</span><br><span class="line">"lisi"</span><br></pre></td></tr></table></figure><p><code>hgetall key</code> 获取指定 key 所有的 field 和 value</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hgetall myhash</span><br><span class="line">1) "username"</span><br><span class="line">2) "lisi"</span><br><span class="line">3) "password"</span><br><span class="line">4) "123"</span><br></pre></td></tr></table></figure><p><strong>删除</strong>：<code>hdel key field</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hdel myhash password</span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure><h4 id="操作有序列表类型数据"><a href="#操作有序列表类型数据" class="headerlink" title="操作有序列表类型数据"></a>操作有序列表类型数据</h4><p><strong>添加</strong>：<br><code>lpush key value</code> 将元素加入列表的左边</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lpush myList a</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; lpush myList b</span><br><span class="line">(integer) 2</span><br></pre></td></tr></table></figure><p><code>rpush key value</code> 将元素加入列表的右边</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; rpush myList c</span><br><span class="line">(integer) 3</span><br><span class="line">```					</span><br><span class="line">**获取**：</span><br><span class="line">`lrange key <span class="keyword">start</span> <span class="keyword">end</span><span class="string">` 范围获取</span></span><br><span class="line"><span class="string">`</span><span class="string">``</span><span class="keyword">sql</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; lrange myList <span class="number">0</span> <span class="number">-1</span></span><br><span class="line"><span class="number">1</span>) <span class="string">"b"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"a"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"c"</span></span><br></pre></td></tr></table></figure><p><strong>删除</strong>：<br><code>lpop key</code> 删除列表最左边的元素，并将元素返回<br><code>rpop key</code> 删除列表最右边的元素，并将元素返回</p><h4 id="操作无序集合类型数据"><a href="#操作无序集合类型数据" class="headerlink" title="操作无序集合类型数据"></a>操作无序集合类型数据</h4><p><strong>存储</strong>：<code>sadd key value</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sadd myset a</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd myset a</span><br><span class="line">(integer) 0</span><br></pre></td></tr></table></figure><p><strong>获取</strong>:<br><code>smembers key</code> 获取set集合中所有元素</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; smembers myset</span><br><span class="line">1) "a"</span><br></pre></td></tr></table></figure><p><strong>删除</strong>：<br><code>srem key value</code> 删除set集合中的某个元素</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; srem myset a</span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure><h4 id="操作有序集合类型数据"><a href="#操作有序集合类型数据" class="headerlink" title="操作有序集合类型数据"></a>操作有序集合类型数据</h4><p><strong>存储</strong>：<br><code>zadd key score value</code> 存储元素时指定权重 ， score:分数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd mysort 60 zhangsan</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd mysort 50 lisi</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd mysort 80 wangwu</span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure><p><strong>获取</strong>：<code>zrange key start end [withscores]</code> 可通过携带 withscores 查看对应元素权重</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrange mysort 0 -1</span><br><span class="line">1) "lisi"</span><br><span class="line">2) "zhangsan"</span><br><span class="line">3) "wangwu"</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; zrange mysort 0 -1 withscores</span><br><span class="line">1) "zhangsan"</span><br><span class="line">2) "60"</span><br><span class="line">3) "wangwu"</span><br><span class="line">4) "80"</span><br><span class="line">5) "lisi"</span><br><span class="line">6) "500"</span><br></pre></td></tr></table></figure><p><strong>删除</strong>：<code>zrem key value</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrem mysort lisi</span><br><span class="line">(integer) 1</span><br></pre></td></tr></table></figure><h3 id="Redis-持久化"><a href="#Redis-持久化" class="headerlink" title="Redis 持久化"></a>Redis 持久化</h3><p>Redis为了保证效率，数据缓存在了内存中，但是会周期性的把更新的数据写入磁盘或者把修改操作写入追加的记录文件中，以保证数据的持久化。Redis的持久化策略有两种：</p><h4 id="RDB"><a href="#RDB" class="headerlink" title="RDB"></a>RDB</h4><p>RDB (快照)持久化：保存某个时间点的全量数据快照<br>默认持久化方式，不需要进行配置，默认就使用这种机制，原理就是：在一定的间隔时间中，检测 key 的变化情况，然后持久化到一个<code>dump.rdb</code>文件中，对于主从同步来说，主从刚刚连接的时候，进行全量同步（RDB）；全同步结束后，进行增量同步(AOF)</p><p><label style="color:#4285f4">编辑</label><code>redis.windwos.conf</code> 文件：找到下面的配置，它们设置了在某个时间段内多少个 key 发生改变就会触发 RDB 持久化，我们按需求改变某种触发机制</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#   after 900 sec (15 min) if at least 1 key changed  #15分钟内有1个键发生改变则触发 RDB</span><br><span class="line">save 900 1</span><br><span class="line">#   after 300 sec (5 min) if at least 10 keys changed #5分钟内有10个键发生改变则触发 RDB</span><br><span class="line">save 300 10</span><br><span class="line">#  after 60 sec if at least 10000 keys changed        #1分钟内有10000个键发生改变则触发 RDB</span><br><span class="line">save 60 10000</span><br></pre></td></tr></table></figure><p><label style="color:red">重启</label>Redis 服务器：根目录下进入 cmd 输入以下命令(指定 Redis 服务器加载时的配置文件)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D:\work\Redis&gt;redis-server.exe redis.windows.conf</span><br></pre></td></tr></table></figure><h4 id="AOF"><a href="#AOF" class="headerlink" title="AOF"></a>AOF</h4><p>AOF(Append-Only-File) 持久化：可以记录每条命令的操作，以日志形式追加保存到一个 AOF 文件中（增量形式）</p><p><label style="color:#4285f4">编辑</label><code>redis.windwos.conf</code> 文件：找到 appendonly no（关闭 AOF ） 修改为 appendonly yes （开启 AOF ），同步改为每一秒执行一次持久化。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">appendonly no &#x3D;&gt; appendonly yes</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"># appendfsync always         # 每一次操作都进行持久化</span><br><span class="line">appendfsync everysec         # 每隔一秒进行一次持久化</span><br><span class="line"># appendfsync no &#x3D;&gt; appendfsync yes</span><br></pre></td></tr></table></figure><h3 id="Java-连接-Redis"><a href="#Java-连接-Redis" class="headerlink" title="Java 连接 Redis"></a>Java 连接 Redis</h3><ol><li>导入 jar 包</li><li>创建 Jedis 对象</li><li>操作 Redis 数据库</li><li>断开连接</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"localhost"</span>, <span class="number">6379</span>);</span><br><span class="line">jedis.set(<span class="string">"name"</span>,<span class="string">"lisi"</span>);</span><br><span class="line">jedis.close();</span><br></pre></td></tr></table></figure><h4 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h4><h5 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h5><p>存储：set(K,V)</p><p>获取：V get(K)</p><p>设置键的过期时间：setex(K,outtime,V)</p><h5 id="哈希"><a href="#哈希" class="headerlink" title="哈希"></a>哈希</h5><p>存储：hset(K,Field,V)</p><p>获取：V hget(K,Field)</p><p>获取所有：Map&lt; String,String &gt; hgetAll(K)</p><h5 id="有序列表"><a href="#有序列表" class="headerlink" title="有序列表"></a>有序列表</h5><p>从列表左边依次开始存储（ Vn 为最左边的元素）：lpush(K,V1,V2…Vn)</p><p>从列表左边依次开始存储（ Vn 为最右边的元素）：rpush(K,V1,V2…Vn)</p><p>范围获取（ 0 到 -1 代表获取所有）：List&lt; String &gt; lrange(K,0,-1)</p><p>弹出最左边的元素：V lpop(K)</p><p>弹出最右边的元素：V rpop(K)</p><h5 id="无序集合"><a href="#无序集合" class="headerlink" title="无序集合"></a>无序集合</h5><p>存储：sadd(K,V1,V2…Vn)</p><p>获取所有：Set&lt; String &gt; smembers(K)</p><h5 id="有序集合"><a href="#有序集合" class="headerlink" title="有序集合"></a>有序集合</h5><p>存储：zadd(K,SCORE,V)</p><p>范围获取（ 0 到 -1 代表获取所有）：Set&lt; String &gt; zrange(K,0,-1)</p><h4 id="JedisPool-连接池"><a href="#JedisPool-连接池" class="headerlink" title="JedisPool 连接池"></a>JedisPool 连接池</h4><p>1.导入 commons-poolx-x.x.jar 包<br>2.创建 JedisPool 连接池对象<br>3.调用方法 getResource() 获取 Jedis 连接</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//0.创建一个配置对象</span></span><br><span class="line">JedisPoolConfig config = <span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line">config.setMaxTotal(<span class="number">60</span>);</span><br><span class="line">config.setMaxIdle(<span class="number">20</span>);</span><br><span class="line"><span class="comment">//1.创建 Jedis 连接池对象</span></span><br><span class="line">JedisPool jedisPool = <span class="keyword">new</span> JedisPool(config,<span class="string">"localhost"</span>,<span class="number">6379</span>);</span><br><span class="line"><span class="comment">//2. 获取连接</span></span><br><span class="line">Jedis jedis = jedisPool.getResource();</span><br><span class="line"><span class="comment">//3. 操作 Redis</span></span><br><span class="line">jedis.set(<span class="string">"name"</span>,<span class="string">"honey"</span>);</span><br><span class="line"><span class="comment">//4. 归还到连接池中</span></span><br><span class="line">jedis.close();</span><br></pre></td></tr></table></figure><p>可以发现每次使用连接池时都要新建连接池，为了避免频繁创建造成不必要的开销，便于管理，可以使用连接池工具类优化</p><p>1)<label style="color:green">创建</label>配置文件 <code>jedis.properties</code></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 主机IP</span></span><br><span class="line"><span class="attr">host</span>=<span class="string">127.0.0.1</span></span><br><span class="line"><span class="comment"># 端口号</span></span><br><span class="line"><span class="attr">port</span>=<span class="string">6379</span></span><br><span class="line"><span class="comment"># 最大连接数</span></span><br><span class="line"><span class="attr">maxTotal</span>=<span class="string">50</span></span><br><span class="line"><span class="comment"># 最大闲置连接数</span></span><br><span class="line"><span class="attr">maxIdle</span>=<span class="string">10</span></span><br></pre></td></tr></table></figure><p>2)<label style="color:green">创建</label>工具类 <code>JedisPoolUtil</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JedisPoolUtil</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="title">JedisPoolUtil</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> JedisPool jedisPool;</span><br><span class="line">  <span class="comment">// 类加载时读取配置文件</span></span><br><span class="line">  <span class="keyword">static</span> &#123;</span><br><span class="line">      InputStream is = JedisPoolUtil.class.getClassLoader().getResourceAsStream("jedis.properties");</span><br><span class="line">      Properties prop = <span class="keyword">new</span> Properties();</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">          prop.load(is);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">          e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line">      JedisPoolConfig config = <span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">int</span> maxIdle = Integer.parseInt(prop.getProperty(<span class="string">"maxIdle"</span>));</span><br><span class="line">      <span class="keyword">int</span> maxTotal = Integer.parseInt(prop.getProperty(<span class="string">"maxTotal"</span>));</span><br><span class="line">      <span class="keyword">int</span> port = Integer.parseInt(prop.getProperty(<span class="string">"port"</span>));</span><br><span class="line">      String host = prop.getProperty(<span class="string">"host"</span>);</span><br><span class="line"></span><br><span class="line">      config.setMaxIdle(maxIdle);</span><br><span class="line">      config.setMaxTotal(maxTotal);</span><br><span class="line">      jedisPool = <span class="keyword">new</span> JedisPool(config, host, port);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 获取 Jedis 连接</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Jedis <span class="title">getJedis</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="keyword">return</span> jedisPool.getResource();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3)<label style="color:#1cb7ff">使用</label>连接池工具类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Jedis jedis = JedisPoolUtil.getJedis();</span><br><span class="line">    jedis.set(<span class="string">"Hello"</span>,<span class="string">"World"</span>);</span><br><span class="line">    jedis.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><h4 id="Redis-的数据结构及使用场景"><a href="#Redis-的数据结构及使用场景" class="headerlink" title="Redis 的数据结构及使用场景"></a>Redis 的数据结构及使用场景</h4><ul><li><p>String字符串:字符串类型是 Redis 最基础的数据结构，首先键都是字符串类型，而且 其他几种数据结构都是在字符串类型基础上构建的，我们常使用的 set key value 命令就是字符串。常用在缓存、计数、共享Session、限速等。</p></li><li><p>Hash哈希:在Redis中，哈希类型是指键值本身又是一个键值对结构，哈希可以用来存放用户信息，比如实现购物车。</p></li><li><p>List列表（双向链表）:列表（list）类型是用来存储多个有序的字符串。可以做简单的消息队列的功能。</p></li><li><p>Set集合：集合（set）类型也是用来保存多个的字符串元素，但和列表类型不一 样的是，集合中不允许有重复元素，并且集合中的元素是无序的，不能通过索引下标获取元素。利用 Set 的交集、并集、差集等操作，可以计算共同喜好，全部的喜好，自己独有的喜好等功能。</p></li><li><p>Sorted Set有序集合（跳表实现）：Sorted Set 多了一个权重参数 Score，集合中的元素能够按 Score 进行排列。可以做排行榜应用，取 TOP N 操作。</p></li></ul><h4 id="Redis-缓存雪崩问题"><a href="#Redis-缓存雪崩问题" class="headerlink" title="Redis 缓存雪崩问题"></a>Redis 缓存雪崩问题</h4><p>什么情况下会出现?</p><p>缓存雪崩是因为缓存失效导致数据未加载到内存中，或者缓存时间大面积地过期失效，从而导致所有请求都会去查数据库，导致数据库、CPU和内存负载过高，甚至宕机。</p><p>解决方法：</p><ul><li><strong>Redis集群</strong>: 使用<code>Redis</code>高可用架构，使用来保证其缓存服务不会挂掉</li><li><strong>设置不同的过期时间</strong>: 在即将发生大并发访问前手动触发加载缓存不同的key，让缓存失效的时间点尽量均匀。热点缓存永不过期。</li><li><strong>限流降级</strong>: 在缓存失效后，通过加锁或者队列来控制读数据库写缓存的线程数量。比如对某个<code>key</code>只允许一个线程查询数据和写缓存，其他线程等待。</li></ul><h4 id="Redis-缓存穿透问题"><a href="#Redis-缓存穿透问题" class="headerlink" title="Redis 缓存穿透问题"></a>Redis 缓存穿透问题</h4><p>什么情况下会出现?</p><p>当查询一个数据库<strong>必不存在的数据</strong>时，此时首先到<code>redis</code>查，发现没有（缓存未命中），然后直接通过持久层向数据库查询，发现也没有，当用户很多的时候，这些缓存都没有命中，于是压力都到了数据库，这时候就出现了缓存穿透。</p><p>解决方法：</p><ul><li><strong>接口校验</strong>：如用户鉴权校验，id做基础校验，id&lt;=0 的直接拦截</li><li><strong>缓存 null 值</strong>：从缓存取不到的数据，如果在数据库中也没有取到，这时也可以将key-value对写为key-null，缓存有效时间可以设置为 t，如t &lt;= 30秒（设置太长会导致正常情况也没法使用）。这样可以防止攻击用户反复用同一个id暴力攻击</li><li><strong>布隆过滤器拦截</strong>:布隆过滤器是一种数据结构，我们将所有可能的查询<code>key</code>以哈希形式映射到布隆过滤器中，查询时先判断<code>key</code>是否存在布隆过滤器中，存在才继续向下执行，如果不存在，则直接返回。布隆过滤器将值进行多次哈希存储，布隆过滤器说某个元素在，可能会被误判。布隆过滤器说某个元素不在，那么一定不在。</li></ul><h4 id="Redis-缓存击穿问题"><a href="#Redis-缓存击穿问题" class="headerlink" title="Redis 缓存击穿问题"></a>Redis 缓存击穿问题</h4><p>这里需要注意和缓存穿透的主要区别缓存击穿指的是<strong>查询缓存中没有而数据库里面有的目标数据</strong>，而缓存穿透是<strong>查询二者都没有的目标数据</strong></p><p>什么情况下会出现?</p><p>当一个热点<code>key</code>，在不停的扛着高并发，集中对这一个<code>key</code>进行访问，当这个<code>key</code>在失效的瞬间，都去直接请求数据库，就像在一个缓存屏障上凿开了一个洞，引起数据库压力瞬间增大。</p><p>解决方法：</p><ul><li><strong>热点数据永远不过期</strong></li><li><strong>互斥锁</strong></li></ul><h4 id="数据备份"><a href="#数据备份" class="headerlink" title="数据备份"></a>数据备份</h4><p>什么是”双活”?<br>主备数据中心之间一般有热备、冷备、双活三种备份方式。</p><p>热备<br>热备的情况下，只有主数据中心承担用户的业务，此时备数据中心对主数据中心进行实时的备份，当主数据中心挂掉以后，备数据中心可以自动接管主数据中心的业务，用户的业务不会中断，所以也感觉不到数据中心的切换。</p><p>冷备<br>冷备的情况下，也是只有主数据中心承担业务，但是备用数据中心不会对主数据中心进行实时备份，这时可能是周期性的进行备份或者干脆不进行备份，如果主数据中心挂掉了，用户的业务就会中断。</p><p>双活<br>双活是觉得备用数据中心只做备份太浪费了，所以让主备两个数据中心都同时承担用户的业务，此时，主备两个数据中心互为备份，并且进行实时备份。一般来说，主数据中心的负载可能会多一些，比如分担60<del>70%的业务，备数据中心只分担40%</del>30%的业务。</p></div><div><div><div style="text-align:center;color:#1b9af7;font-size:14px">----------本文结束&nbsp<i class="fa fa-hourglass-end"></i>&nbsp感谢您的阅读----------</div></div></div><footer class="post-footer"><div class="post-tags"><a href="/sr/tags/note/" rel="tag"><i class="fa fa-tag"></i>note</a> <a href="/sr/tags/NoSQL/" rel="tag"><i class="fa fa-tag"></i>NoSQL</a></div><div class="post-nav"><div class="post-nav-item"><a href="/sr/post/2020-01-03-%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0-Web-2020-01-03-Web04-Ajax/" rel="prev" title="Web04-Ajax"><i class="fa fa-chevron-left"></i> Web04-Ajax</a></div><div class="post-nav-item"><a href="/sr/post/2020-01-04-%E6%9D%82%E9%A1%B9-%E9%A1%B9%E7%9B%AE%E5%B7%A5%E5%85%B7-2020-01-04-Maven/" rel="next" title="Maven">Maven <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div></div><script>window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Redis"><span class="nav-number">1.</span> <span class="nav-text">Redis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Redis-简介"><span class="nav-number">1.1.</span> <span class="nav-text">Redis 简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NoSQL"><span class="nav-number">1.2.</span> <span class="nav-text">NoSQL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Redis-较其他-K-V-数据库的优势"><span class="nav-number">1.3.</span> <span class="nav-text">Redis 较其他 K&#x2F;V 数据库的优势</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Redis-初使用"><span class="nav-number">1.4.</span> <span class="nav-text">Redis 初使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#下载安装"><span class="nav-number">1.4.1.</span> <span class="nav-text">下载安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#配置"><span class="nav-number">1.4.2.</span> <span class="nav-text">配置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Redis-数据的形式"><span class="nav-number">1.5.</span> <span class="nav-text">Redis 数据的形式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#value-的数据类型"><span class="nav-number">1.5.1.</span> <span class="nav-text">value 的数据类型</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Redis-常见命令操作"><span class="nav-number">1.6.</span> <span class="nav-text">Redis 常见命令操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#通用命令"><span class="nav-number">1.6.1.</span> <span class="nav-text">通用命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#操作字符串类型数据"><span class="nav-number">1.6.2.</span> <span class="nav-text">操作字符串类型数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#操作哈希类型数据"><span class="nav-number">1.6.3.</span> <span class="nav-text">操作哈希类型数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#操作有序列表类型数据"><span class="nav-number">1.6.4.</span> <span class="nav-text">操作有序列表类型数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#操作无序集合类型数据"><span class="nav-number">1.6.5.</span> <span class="nav-text">操作无序集合类型数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#操作有序集合类型数据"><span class="nav-number">1.6.6.</span> <span class="nav-text">操作有序集合类型数据</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Redis-持久化"><span class="nav-number">1.7.</span> <span class="nav-text">Redis 持久化</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#RDB"><span class="nav-number">1.7.1.</span> <span class="nav-text">RDB</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AOF"><span class="nav-number">1.7.2.</span> <span class="nav-text">AOF</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Java-连接-Redis"><span class="nav-number">1.8.</span> <span class="nav-text">Java 连接 Redis</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#常用方法"><span class="nav-number">1.8.1.</span> <span class="nav-text">常用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#字符串"><span class="nav-number">1.8.1.1.</span> <span class="nav-text">字符串</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#哈希"><span class="nav-number">1.8.1.2.</span> <span class="nav-text">哈希</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#有序列表"><span class="nav-number">1.8.1.3.</span> <span class="nav-text">有序列表</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#无序集合"><span class="nav-number">1.8.1.4.</span> <span class="nav-text">无序集合</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#有序集合"><span class="nav-number">1.8.1.5.</span> <span class="nav-text">有序集合</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JedisPool-连接池"><span class="nav-number">1.8.2.</span> <span class="nav-text">JedisPool 连接池</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小结"><span class="nav-number">1.9.</span> <span class="nav-text">小结</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Redis-的数据结构及使用场景"><span class="nav-number">1.9.1.</span> <span class="nav-text">Redis 的数据结构及使用场景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Redis-缓存雪崩问题"><span class="nav-number">1.9.2.</span> <span class="nav-text">Redis 缓存雪崩问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Redis-缓存穿透问题"><span class="nav-number">1.9.3.</span> <span class="nav-text">Redis 缓存穿透问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Redis-缓存击穿问题"><span class="nav-number">1.9.4.</span> <span class="nav-text">Redis 缓存击穿问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据备份"><span class="nav-number">1.9.5.</span> <span class="nav-text">数据备份</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="min" src="https://s2.ax1x.com/2019/12/30/lla7HU.gif"><p class="site-author-name" itemprop="name">min</p><div class="site-description" itemprop="description">欢迎瓜友~</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts" id="showPosts"><a href="/sr/archives"><span class="site-state-item-count">59</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories" id="showCategory"><a href="/sr/categories/"><span class="site-state-item-count">16</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags" id="showTag"><a href="/sr/tags/"><span class="site-state-item-count">10</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/xming1001" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xming1001" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:xming1001@163.com" title="E-Mail → mailto:xming1001@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div></div><script type="text/javascript" charset="utf-8" src="/sr/js/tagcloud.js"></script><script type="text/javascript" charset="utf-8" src="/sr/js/tagcanvas.js"></script><div class="widget-wrap"><div id="myCanvasContainer" class="widget tagcloud"><canvas width="250" height="250" id="resCanvas"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/sr/tags/Git/" rel="tag">Git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/sr/tags/Hexo/" rel="tag">Hexo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/sr/tags/IDEA/" rel="tag">IDEA</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/sr/tags/Maven/" rel="tag">Maven</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/sr/tags/MyBatis/" rel="tag">MyBatis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/sr/tags/NoSQL/" rel="tag">NoSQL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/sr/tags/SQL/" rel="tag">SQL</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/sr/tags/SVN/" rel="tag">SVN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/sr/tags/Travis-CI/" rel="tag">Travis CI</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/sr/tags/note/" rel="tag">note</a><span class="tag-list-count">52</span></li></ul></canvas></div></div><div><canvas id="canvas" style="width:60%">当前浏览器不支持canvas，请更换浏览器后再试</canvas></div><script>!function(){function t(t,e){for(var a=0;a<l[e].length;a++)for(var n=0;n<l[e][a].length;n++)1==l[e][a][n]&&(h.beginPath(),h.arc(14*(g+2)*t+2*n*(g+1)+(g+1),2*a*(g+1)+(g+1),g,0,2*Math.PI),h.closePath(),h.fill())}function e(){var t=[],e=/(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date),a=[];a.push(e[1],e[2],10,e[3],e[4],10,e[5],e[6]);for(var r=c.length-1;r>=0;r--)a[r]!==c[r]&&t.push(r+"_"+(Number(c[r])+1)%10);for(var r=0;r<t.length;r++)n.apply(this,t[r].split("_"));c=a.concat()}function a(){for(var t=0;t<d.length;t++)d[t].stepY+=d[t].disY,d[t].x+=d[t].stepX,d[t].y+=d[t].stepY,(d[t].x>i+g||d[t].y>f+g)&&(d.splice(t,1),t--)}function n(t,e){for(var a=[1,2,3],n=["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"],r=0;r<l[e].length;r++)for(var o=0;o<l[e][r].length;o++)if(1==l[e][r][o]){var h={x:14*(g+2)*t+2*o*(g+1)+(g+1),y:2*r*(g+1)+(g+1),stepX:Math.floor(4*Math.random()-2),stepY:-2*a[Math.floor(Math.random()*a.length)],color:n[Math.floor(Math.random()*n.length)],disY:1};d.push(h)}}function r(){o.height=100;for(var e=0;e<c.length;e++)t(e,c[e]);for(var e=0;e<d.length;e++)h.beginPath(),h.arc(d[e].x,d[e].y,g,0,2*Math.PI),h.fillStyle=d[e].color,h.closePath(),h.fill()}var l=[[[0,0,1,1,1,0,0],[0,1,1,0,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,0,1,1,0],[0,0,1,1,1,0,0]],[[0,0,0,1,1,0,0],[0,1,1,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[1,1,1,1,1,1,1]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,0,0,1,1],[1,1,1,1,1,1,1]],[[1,1,1,1,1,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,0,1,1,1,0],[0,0,1,1,1,1,0],[0,1,1,0,1,1,0],[1,1,0,0,1,1,0],[1,1,1,1,1,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,1,1]],[[1,1,1,1,1,1,1],[1,1,0,0,0,0,0],[1,1,0,0,0,0,0],[1,1,1,1,1,1,0],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,0,0,0,1,1,0],[0,0,1,1,0,0,0],[0,1,1,0,0,0,0],[1,1,0,0,0,0,0],[1,1,0,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[1,1,1,1,1,1,1],[1,1,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,0,0,1,1,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,1,1,0]],[[0,1,1,1,1,1,0],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[1,1,0,0,0,1,1],[0,1,1,1,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,0,1,1],[0,0,0,0,1,1,0],[0,0,0,1,1,0,0],[0,1,1,0,0,0,0]],[[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0]]],o=document.getElementById("canvas");if(o.getContext){var h=o.getContext("2d"),f=100,i=700;o.height=f,o.width=i,h.fillStyle="#f00",h.fillRect(10,10,50,50);var c=[],d=[],g=o.height/20-1;!function(){var t=/(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date);c.push(t[1],t[2],10,t[3],t[4],10,t[5],t[6])}(),clearInterval(v);var v=setInterval(function(){e(),a(),r()},50)}}()</script><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright"><a href="https://xming1001.github.io/sr/" class="fa fa-yelp" id="jump"></a><span id="timeDate" style="color:rgba(241,241,241,.8)">载入天数...</span> <span id="times" style="color:rgba(241,241,241,.8)">载入时分秒...</span><script>function createtime(){var n=new Date("10/01/2019 8:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML=" Xm 的小站已运行了 "+dnum+" 天 ",document.getElementById("times").innerHTML=hnum+" 时 "+mnum+" 分 "+snum+" 秒"}var now=new Date;setInterval("createtime()",250)</script><div style="color:rgba(241,241,241,.8)"><a href="https://xming1001.github.io/sr/" class="fa fa-yelp" style="color:rgba(241,241,241,.8)"></a> 小站总访客数：<span id="busuanzi_value_site_uv"></span>&nbsp人 <a href="https://xming1001.github.io/sr/" class="fa fa-yelp" style="color:rgba(241,241,241,.8)"></a> 小站总访问量：<span id="busuanzi_value_site_pv"></span>&nbsp次</div></div></div></footer></div><script src="/sr/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/lozad.js/1.9.0/lozad.min.js"></script><script src="/sr/lib/velocity/velocity.min.js"></script><script src="/sr/lib/velocity/velocity.ui.min.js"></script><script src="/sr/js/utils.js"></script><script src="/sr/js/motion.js"></script><script src="/sr/js/schemes/pisces.js"></script><script src="/sr/js/next-boot.js"></script><script src="/sr/js/local-search.js"></script><script>NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//cdnjs.cloudflare.com/ajax/libs/valine/1.3.10/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el: '#valine-comments',
      verify: false,
      notify: false,
      appId: '0VbITUQA3fmK0vbokUBDF7KN-gzGzoHsz',
      appKey: 'X3MeRhUqCp8hYNQMr9OKyHmY',
      placeholder: "欢迎交流讨论...",
      avatar: 'robohash',
      meta: guest,
      pageSize: '5' || 10,
      visitor: false,
      lang: 'zh-cn' || 'zh-cn',
      path: location.pathname,
      recordIP: false,
      serverURLs: ''
    });
  }, window.Valine);
});</script></body></html><script type="text/javascript" src="/sr/js/clicklove.js"></script><!-- rebuild by neat -->